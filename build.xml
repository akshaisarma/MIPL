<project name="MIPL" default="mipl" basedir=".">
    <tstamp/>
    <property name="src" location="src" />
    <property name="docs" location="docs" />
    <property name="lib" location="lib" />
    <property name="tool" location="tools" />
    <property name="build" location="build" />
    <property name="test" location="test" />
    <property name="test_result" location="test_result" />
    <property name="dist" location="dist" />

    <target name="mipl" description="MIPL compiler">
	    <mkdir dir="${build}" />
	    <javac srcdir="${src}" destdir="${build}" >
		    <classpath>
			    <pathelement path="${classpath}"/>
			    <fileset dir="${lib}">
				    <include name="**/*.jar"/>
			    </fileset>
		    </classpath>
	    </javac>
	    <antcall target="checkstyle"/>
    </target>

    <target name="test_ds" depends="mipl" description="Data Structure Testing">
        <mkdir dir="${test_result}" />
        <mkdir dir="${dist}" />
        <jar jarfile="${dist}/mipl_ds.${DSTAMP}.jar">
            <fileset dir="${build}/edu/columbia/mipl/datastr/" />
        </jar>
        <javac srcdir="${test}/testing_ds" destdir="${test_result}"
            classpath="${dist}/mipl_ds.${DSTAMP}.jar" />
    </target>

    <target name="clean" description="Clean Project">
        <delete dir="${build}" />
        <delete dir="${dist}" />
        <delete dir="${test_result}" />
    </target>

    <taskdef resource="checkstyletask.properties" classpath="${tool}/checkstyle-5.5-all.jar" />

    <target name="checkstyle" description="Generates a report of code convention violations.">
        <checkstyle config="${docs}/sun_checks.xml">
            <fileset dir="src" includes="**/*.java"/>
            <formatter type="plain"/>
        </checkstyle>
    </target>


</project>
